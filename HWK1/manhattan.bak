(define manhattan
  (lambda (board)
    (begin
      (define count 0)
      (define place (one board))
      (cond
        ((equal? place 1) (set! count (+ count 0)))
        ((equal? place 2) (set! count (+ count 1)))
        ((equal? place 3) (set! count (+ count 2)))
        ((equal? place 4) (set! count (+ count 1)))
        ((equal? place 5) (set! count (+ count 2)))
        ((equal? place 6) (set! count (+ count 3)))
        ((equal? place 7) (set! count (+ count 2)))
        ((equal? place 8) (set! count (+ count 3))))
      (set! place (two board))
      (cond
        ((equal? place 1) (set! count (+ count 1)))
        ((equal? place 2) (set! count (+ count 0)))
        ((equal? place 3) (set! count (+ count 1)))
        ((equal? place 4) (set! count (+ count 2)))
        ((equal? place 5) (set! count (+ count 1)))
        ((equal? place 6) (set! count (+ count 2)))
        ((equal? place 7) (set! count (+ count 3)))
        ((equal? place 8) (set! count (+ count 2))))
      (set! place (three board))
      (cond
        ((equal? place 1) (set! count (+ count 2)))
        ((equal? place 2) (set! count (+ count 1)))
        ((equal? place 3) (set! count (+ count 0)))
        ((equal? place 4) (set! count (+ count 3)))
        ((equal? place 5) (set! count (+ count 2)))
        ((equal? place 6) (set! count (+ count 1)))
        ((equal? place 7) (set! count (+ count 4)))
        ((equal? place 8) (set! count (+ count 3))))
      (set! place (four board))
      (cond
        ((equal? place 1) (set! count (+ count 1)))
        ((equal? place 2) (set! count (+ count 2)))
        ((equal? place 3) (set! count (+ count 3)))
        ((equal? place 4) (set! count (+ count 0)))
        ((equal? place 5) (set! count (+ count 1)))
        ((equal? place 6) (set! count (+ count 6)))
        ((equal? place 7) (set! count (+ count 1)))
        ((equal? place 8) (set! count (+ count 2))))
      (set! place (five board))
      (cond
        ((equal? place 1) (set! count (+ count 2)))
        ((equal? place 2) (set! count (+ count 1)))
        ((equal? place 3) (set! count (+ count 2)))
        ((equal? place 4) (set! count (+ count 1)))
        ((equal? place 5) (set! count (+ count 0)))
        ((equal? place 6) (set! count (+ count 1)))
        ((equal? place 7) (set! count (+ count 2)))
        ((equal? place 8) (set! count (+ count 1))))
      (set! place (six board))
      (cond
        ((equal? place 1) (set! count (+ count 3)))
        ((equal? place 2) (set! count (+ count 2)))
        ((equal? place 3) (set! count (+ count 1)))
        ((equal? place 4) (set! count (+ count 4)))
        ((equal? place 5) (set! count (+ count 1)))
        ((equal? place 6) (set! count (+ count 0)))
        ((equal? place 7) (set! count (+ count 3)))
        ((equal? place 8) (set! count (+ count 2))))
      (set! place (seven board))
      (cond
        ((equal? place 1) (set! count (+ count 2)))
        ((equal? place 2) (set! count (+ count 3)))
        ((equal? place 3) (set! count (+ count 4)))
        ((equal? place 4) (set! count (+ count 1)))
        ((equal? place 5) (set! count (+ count 2)))
        ((equal? place 6) (set! count (+ count 3)))
        ((equal? place 7) (set! count (+ count 0)))
        ((equal? place 8) (set! count (+ count 1))))
      (set! place (eight board))
      (cond
        ((equal? place 1) (set! count (+ count 3)))
        ((equal? place 2) (set! count (+ count 2)))
        ((equal? place 3) (set! count (+ count 3)))
        ((equal? place 4) (set! count (+ count 2)))
        ((equal? place 5) (set! count (+ count 1)))
        ((equal? place 6) (set! count (+ count 2)))
        ((equal? place 7) (set! count (+ count 1)))
        ((equal? place 8) (set! count (+ count 0))))
      (set! place (nine board))
      (cond
        ((equal? place 1) (set! count (+ count 4)))
        ((equal? place 2) (set! count (+ count 3)))
        ((equal? place 3) (set! count (+ count 2)))
        ((equal? place 4) (set! count (+ count 3)))
        ((equal? place 5) (set! count (+ count 2)))
        ((equal? place 6) (set! count (+ count 1)))
        ((equal? place 7) (set! count (+ count 2)))
        ((equal? place 8) (set! count (+ count 1))))
      count)))
    